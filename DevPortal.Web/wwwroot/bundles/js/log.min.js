function isNullOrEmpty(n){return n===undefined||n===null||n.trim()===""}function clearDropdown(n){n.find("option").not(":first").remove()}function getApplicationList(n){var t=$("#__AjaxAntiForgeryForm"),i=$('input[name="__RequestVerificationToken"]',t).val();$.ajax({url:"/Log/GetApplicationsList",datatype:"JSON",contenttype:"application/json",type:"POST","async":!0,data:{__RequestVerificationToken:i,applicationGroupId:n},success:function(n){n.isSuccess&&n.data.length!==0&&$.each(n.data,function(n,t){$("#application").append("<option value="+t.id+">"+t.name+"<\/option>")})},error:function(){}})}function getEnvironmentList(n){var t=$("#__AjaxAntiForgeryForm"),i=$('input[name="__RequestVerificationToken"]',t).val();$.ajax({url:"/ApplicationEnvironment/GetEnvironmentList",datatype:"JSON",contenttype:"environment/json",type:"POST","async":!0,data:{__RequestVerificationToken:i,applicationId:n},success:function(n){n.isSuccess&&n.data.length!==0&&$.each(n.data,function(n,t){$("#environment").append("<option value="+t.logFilePath+">"+t.environmentName+"<\/option>")})},error:function(){}})}function validateSearch(){return isNullOrEmpty($applicationGroup.val())?($applicationGroup.addClass("is-invalid"),!1):($applicationGroup.removeClass("is-invalid"),isNullOrEmpty($application.val()))?($application.addClass("is-invalid"),!1):($application.removeClass("is-invalid"),isNullOrEmpty($environment.val()))?($environment.addClass("is-invalid"),!1):($environment.removeClass("is-invalid"),!0)}function validateTextSearch(){return isNullOrEmpty($applicationPhysicalPath.val())?($applicationPhysicalPath.addClass("is-invalid"),!1):($applicationPhysicalPath.removeClass("is-invalid"),!0)}function createFilePathHtml(){$("#log-file-table_filter").parent().prev().html('<i style="cursor:pointer;" class="fa fa-file text-primary float-left mr-1 mt-2 btn-sm"><\/i><p class="mt-2" id="file-path">'+$applicationPhysicalPath.val()+"<\/p>")}function setApplicationPhysicalPathForButtonSearch(){var n=$applicationPhysicalPath.val(),t;n.indexOf("archive")!=="-1"&&(t=n.replace("archive",""),$applicationPhysicalPath.val(t))}function setApplicationPhysicalPathForArchiveButtonSearch(){var n=$applicationPhysicalPath.val();n.indexOf("archive")=="-1"&&$applicationPhysicalPath.val(n+"archive")}var $applicationGroup=$("#applicationGroup"),$application=$("#application"),$environment=$("#environment"),$applicationPhysicalPath=$("#applicationPhysicalPath"),$btnSearch=$("#btnSearch"),$btnSearchAchive=$("#selectArchive"),$txtSearch=$("#txtSearch"),$txtSearchArchive=$("#searchArchive"),$form=$("#__AjaxAntiForgeryForm"),$token=$('input[name="__RequestVerificationToken"]',$form),initialLoad=!0,dataTable=$("#log-file-table").DataTable({language:{url:"//cdn.datatables.net/plug-ins/1.10.12/i18n/Turkish.json"},columns:[{data:"name",render:function(n,t,i){return"<a href=/Log/LogDetails?path="+i.path+' class = "font-weight-normal" target = "_blank">'+i.name+"<\/a >"}},{data:"modifiedDate",render:function(n,t,i){return i.dateModified}},{data:"size",render:function(n,t,i){return i.size+" KB"}},{data:"path",render:function(n,t,i){return'<div class="text-center"><a href=/Log/DownloadLogFile?path='+i.filePath+' type="file" title="Ä°ndir" > <i class="fa fa-download" aria-hidden="true"><\/i ><\/a ><\/div>'},orderable:!1,searchable:!1}],order:[[1,"asc"]],columnDefs:[{targets:1,type:"modifiedDate"},{targets:2,type:"size"}],processing:!0,serverSide:!1,ajax:{url:"Log/GetResultFileListPartial",method:"POST",data:function(n){n.__RequestVerificationToken=$token.val();n.physicalPath=$applicationPhysicalPath.val()},dataSrc:function(n){return initialLoad?(initialLoad=!1,[]):n.isSuccess?(createFilePathHtml(),n.data):($("#log-file-table_filter").parent().prev().empty(),$(".toast").toast("show"),[])}},searching:!0,paging:!0,lengthChange:!1,pageLength:10});$(document).ready(function(){function n(){$(".toast").toast("show")}isNullOrEmpty($applicationPhysicalPath.val())||$("#get-Physical-Path").trigger("click");$applicationGroup.on("change",function(){var n=$(this).val();clearDropdown($application);clearDropdown($environment);n>0&&($(this).removeClass("is-invalid"),getApplicationList(n))});$application.on("change",function(){var n=$(this).val();clearDropdown($environment);n>0&&($(this).removeClass("is-invalid"),getEnvironmentList(n))});$environment.on("change",function(){var n=$(this).val();isNullOrEmpty(n)||($(this).removeClass("is-invalid"),$applicationPhysicalPath.val(n))});$btnSearch.on("click",function(){var t=validateSearch();t||n();document.getElementById("selectArchive").checked==!0?(setApplicationPhysicalPathForArchiveButtonSearch(),dataTable.ajax.reload()):(setApplicationPhysicalPathForButtonSearch(),dataTable.ajax.reload())});$txtSearch.on("click",function(){var t=validateTextSearch();t||n();document.getElementById("searchArchive").checked==!0?(setApplicationPhysicalPathForArchiveButtonSearch(),dataTable.ajax.reload()):(setApplicationPhysicalPathForButtonSearch(),clearDropdown($application),clearDropdown($environment),dataTable.ajax.reload())});var t=document.getElementById("applicationPhysicalPath");t.addEventListener("keyup",function(n){n.keyCode===13&&(n.preventDefault(),document.getElementById("txtSearch").click())});$.extend($.fn.dataTable.ext.type.order,{"modifiedDate-asc":function(n,t){var i=new Date(n),r=new Date(t);return i<r?1:-1},"modifiedDate-desc":function(n,t){var i=new Date(n),r=new Date(t);return console.log(i),console.log(r),i>=r?1:-1},"size-asc":function(n,t){var i=parseInt(n.split(" KB")[0]),r=parseInt(t.split(" KB")[0]);return i<r?1:-1},"size-desc":function(n,t){var i=parseInt(n.split(" KB")[0]),r=parseInt(t.split(" KB")[0]);return i>=r?1:-1}})});